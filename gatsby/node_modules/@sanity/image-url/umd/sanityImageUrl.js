(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.SanityImageUrlBuilder = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
module.exports=require("./lib/builder").default;
},{"./lib/builder":2}],2:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function urlBuilder(t){return t&&"object"===_typeof(t.clientConfig)?new ImageUrlBuilder(null,{baseUrl:t.clientConfig.apiHost.replace(/^https:\/\/api\./,"https://cdn."),projectId:t.clientConfig.projectId,dataset:t.clientConfig.dataset}):new ImageUrlBuilder(null,t)}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();exports.default=urlBuilder;var _urlForImage=require("./urlForImage"),_urlForImage2=_interopRequireDefault(_urlForImage),validFits=["clip","crop","fill","fillmax","max","scale","min"],validCrops=["top","bottom","left","right","center","focalpoint","entropy"],ImageUrlBuilder=function(){function t(e,i){_classCallCheck(this,t),this.options=e?Object.assign({},e.options,i||{}):i||{}}return _createClass(t,[{key:"withOptions",value:function(e){return new t(this,e)}},{key:"image",value:function(t){return this.withOptions({source:t})}},{key:"dataset",value:function(t){return this.withOptions({dataset:t})}},{key:"projectId",value:function(t){return this.withOptions({projectId:t})}},{key:"width",value:function(t){return this.withOptions({width:t})}},{key:"height",value:function(t){return this.withOptions({height:t})}},{key:"focalPoint",value:function(t,e){return this.withOptions({focalPoint:{x:t,y:e}})}},{key:"maxWidth",value:function(t){return this.withOptions({maxWidth:t})}},{key:"minWidth",value:function(t){return this.withOptions({minWidth:t})}},{key:"maxHeight",value:function(t){return this.withOptions({maxHeight:t})}},{key:"minHeight",value:function(t){return this.withOptions({minHeight:t})}},{key:"size",value:function(t,e){return this.withOptions({width:t,height:e})}},{key:"blur",value:function(t){return this.withOptions({blur:t})}},{key:"sharpen",value:function(t){return this.withOptions({sharpen:t})}},{key:"rect",value:function(t,e,i,n){return this.withOptions({rect:{left:t,top:e,width:i,height:n}})}},{key:"format",value:function(t){return this.withOptions({format:t})}},{key:"invert",value:function(t){return this.withOptions({invert:t})}},{key:"orientation",value:function(t){return this.withOptions({orientation:t})}},{key:"quality",value:function(t){return this.withOptions({quality:t})}},{key:"forceDownload",value:function(t){return this.withOptions({download:t})}},{key:"flipHorizontal",value:function(){return this.withOptions({flipHorizontal:!0})}},{key:"flipVertical",value:function(){return this.withOptions({flipVertical:!0})}},{key:"ignoreImageParams",value:function(){return this.withOptions({ignoreImageParams:!0})}},{key:"fit",value:function(t){if(-1===validFits.indexOf(t))throw new Error('Invalid fit mode "'+t+'"');return this.withOptions({fit:t})}},{key:"crop",value:function(t){if(-1===validCrops.indexOf(t))throw new Error('Invalid crop mode "'+t+'"');return this.withOptions({crop:t})}},{key:"url",value:function(){return(0,_urlForImage2.default)(this.options)}},{key:"toString",value:function(){return this.url()}}]),t}();
},{"./urlForImage":5}],3:[function(require,module,exports){
"use strict";function parseAssetId(r){var e=r.split("-"),t=_slicedToArray(e,4),i=t[1],a=t[2],n=t[3];if(!i||!a||!n)throw new Error("Malformed asset _ref '"+r+"'. Expected an id like \""+example+'".');var o=a.split("x"),s=_slicedToArray(o,2),l=s[0],u=s[1],d=+l,f=+u;if(!Number.isFinite(d)||!Number.isFinite(f))throw new Error("Malformed asset _ref '"+r+"'. Expected an id like \""+example+'".');return{id:i,width:d,height:f,format:n}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function r(r,e){var t=[],i=!0,a=!1,n=void 0;try{for(var o,s=r[Symbol.iterator]();!(i=(o=s.next()).done)&&(t.push(o.value),!e||t.length!==e);i=!0);}catch(r){a=!0,n=r}finally{try{!i&&s.return&&s.return()}finally{if(a)throw n}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.default=parseAssetId;var example="image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg";

},{}],4:[function(require,module,exports){
"use strict";function parseSource(t){if(!t)return null;var e=void 0;if("string"==typeof t&&isUrl(t))e={asset:{_ref:urlToId(t)}};else if("string"==typeof t)e={asset:{_ref:t}};else if("string"==typeof t._ref)e={asset:t};else if(t._id)e={asset:{_ref:t._id}};else if(t.asset&&t.asset.url&&!t.asset._ref)e={asset:{_ref:urlToId(t.asset.url)}};else{if("object"!==_typeof(t.asset))return null;e=t}return t.crop&&(e.crop=t.crop),t.hotspot&&(e.hotspot=t.hotspot),applyDefaults(e)}function isUrl(t){return/^https?:\/\//.test(""+t)}function urlToId(t){return("image-"+t.split("/").slice(-1)[0]).replace(/\.([a-z]+)$/,"-$1")}function applyDefaults(t){return t.crop&&t.hotspot?t:Object.assign({crop:{left:0,top:0,bottom:0,right:0},hotspot:{x:.5,y:.5,height:1,width:1}},t)}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};exports.default=parseSource;
},{}],5:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function urlForImage(t){var e=Object.assign({},t||{}),r=e.source;delete e.source;var o=(0,_parseSource2.default)(r);if(!o)return null;var i=(0,_parseAssetId2.default)(o.asset._ref),h={left:Math.round(o.crop.left*i.width),top:Math.round(o.crop.top*i.height)};h.width=Math.round(i.width-o.crop.right*i.width-h.left),h.height=Math.round(i.height-o.crop.bottom*i.height-h.top);var a=o.hotspot.height*i.height/2,n=o.hotspot.width*i.width/2,s=o.hotspot.x*i.width,p=o.hotspot.y*i.height,u={left:s-n,top:p-a,right:s+n,bottom:p+n};return e.asset=i,e.rect||e.focalPoint||e.ignoreImageParams||e.crop||(e=Object.assign(e,fit({crop:h,hotspot:u},e))),specToImageUrl(e)}function specToImageUrl(t){var e=t.baseUrl||"https://cdn.sanity.io",r=t.asset.id+"-"+t.asset.width+"x"+t.asset.height+"."+t.asset.format,o=e+"/images/"+t.projectId+"/"+t.dataset+"/"+r,i=[];if(t.rect){(0!=t.rect.left||0!=t.rect.top||t.rect.height!=t.asset.height||t.rect.width!=t.asset.width)&&i.push("rect="+t.rect.left+","+t.rect.top+","+t.rect.width+","+t.rect.height)}return t.focalPoint&&(i.push("fp-x="+t.focalPoint.x),i.push("fp-x="+t.focalPoint.y)),(t.flipHorizontal||t.flipVertical)&&i.push("flip="+(t.flipHorizontal?"h":"")+(t.flipVertical?"v":"")),SPEC_NAME_TO_URL_NAME_MAPPINGS.forEach(function(e){var r=_slicedToArray(e,2),o=r[0],h=r[1];void 0!==t[o]?i.push(h+"="+encodeURIComponent(t[o])):void 0!==t[h]&&i.push(h+"="+encodeURIComponent(t[h]))}),0===i.length?o:o+"?"+i.join("&")}function fit(t,e){var r={width:e.width,height:e.height};if(!e.width||!e.height)return r.rect=t.crop,r;var o=t.crop,i=t.hotspot,h=e.width/e.height;if(o.width/o.height>h){var a=o.height,n=a*h,s=o.top,p=(i.right-i.left)/2+i.left,u=p-n/2;return u<o.left?u=o.left:u+n>o.left+o.width&&(u=o.left+o.width-n),r.rect={left:Math.round(u),top:Math.round(s),width:Math.round(n),height:Math.round(a)},r}var l=o.width,c=l/h,d=o.left,f=(i.bottom-i.top)/2+i.top,g=f-c/2;return g<o.top?g=o.top:g+c>o.top+o.height&&(g=o.top+o.height-c),r.rect={left:Math.floor(d),top:Math.floor(g),width:Math.round(l),height:Math.round(c)},r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseSource=void 0;var _slicedToArray=function(){function t(t,e){var r=[],o=!0,i=!1,h=void 0;try{for(var a,n=t[Symbol.iterator]();!(o=(a=n.next()).done)&&(r.push(a.value),!e||r.length!==e);o=!0);}catch(t){i=!0,h=t}finally{try{!o&&n.return&&n.return()}finally{if(i)throw h}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.default=urlForImage;var _parseSource=require("./parseSource"),_parseSource2=_interopRequireDefault(_parseSource),_parseAssetId=require("./parseAssetId"),_parseAssetId2=_interopRequireDefault(_parseAssetId),SPEC_NAME_TO_URL_NAME_MAPPINGS=[["width","w"],["height","h"],["format","fm"],["download","dl"],["blur","blur"],["sharpen","sharp"],["invert","invert"],["orientation","or"],["minHeight","min-h"],["maxHeight","max-h"],["minWidth","min-w"],["maxWidth","max-w"],["quality","q"],["fit","fit"],["crop","crop"]];exports.parseSource=_parseSource2.default;
},{"./parseAssetId":3,"./parseSource":4}]},{},[1])(1)
});
